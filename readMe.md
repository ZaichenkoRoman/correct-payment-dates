# Correct Payment Dates Telegram Bot

![Logo](./logo.jpg)

## Описание
Correct Payment Dates Bot выполняет функцию проверки и обновления данных в Google Spreadsheet таблице,
в соответствии с загруженными в него данными из XLSX файла.

## Принцип работы
Для выполнения своей функции бот осуществляет следующие шаги:

* Предлагает пользователю пройти процедуру идентификации, через команду /login, с вводом сервисного пароля
* Принимает от пользователя документ в формате XLSX (при передаче документа с другим расширением будет выведена ошибка с просьбой загрузить корректный файл)
* Проверяет загруженный документ на наличие колонок с необходимыми названиями (при отсутствии будет выведена ошибка)
* Извлекает из колонки с номером счета, непосредственно номера счетов и сохраняет их вместе с соответствующими им датами
* Сравнивает данные о номерах счетов и датах из загруженного документа с имеющимися данными в Google Spreadsheet таблице
* В случае если поле с датой в Google таблице не было заполнено, заполняет его данными полученными из загруженного документа
* Выводит сообщение пользователю в телеграм, о тех датах, что уже были заполнены ранее и тех, что были добавлены

Бот работает с двумя Google Spreadsheet таблицами:
* MainDataTable - главная таблица, в которой проверяются данные и проставляются даты
* AccessDataTable - вспомогательная таблица, хранящая в себе ID чатов пользователей, прошедших процедуру идентификации и их имена и фамилии

*Все ошибки которые потенциально могут возникнуть в процессе работы бота, отправляются в чат администратору*

## От автора
Автор: [ Заиченко Роман ]  
Контактный email: [ ra.main.w@gmail.com ] 

